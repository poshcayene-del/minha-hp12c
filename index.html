<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a1a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>HP 12c Platinum - Cl√°udio Santos</title>
    
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/4341/4341069.png">
    <link rel="manifest" href='data:application/manifest+json;charset=utf-8,{"name":"HP 12c CS","short_name":"HP 12c CS","start_url":".","display":"standalone","background_color":"#1a1a1a","theme_color":"#1a1a1a","icons":[{"src":"https://cdn-icons-png.flaticon.com/512/4341/4341069.png","sizes":"512x512","type":"image/png"}]}'>

    <style>
        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: #333; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 5px; 
            overflow: hidden; /* Evita rolagem desnecess√°ria no app */
        }

        /* Container Principal Responsivo */
        .hp12c { 
            background: #1a1a1a; 
            width: 100%;
            max-width: 900px; /* Limite para n√£o esticar demais em tablets */
            padding: 2% 2% 8% 2%; 
            border-radius: 12px; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.8); 
            border: 2px solid #000; 
            position: relative;
        }

        .faceplate { 
            background: linear-gradient(180deg, #e0e0e0 0%, #bbbbbb 100%); 
            border-radius: 6px; 
            padding: 15px; 
            border: 1px solid #777; 
        }

        /* Ajuste do Visor e Pilha para caber lado a lado */
        .display-area { 
            display: flex; 
            gap: 10px; 
            align-items: flex-end; 
            margin-bottom: 20px;
            width: 100%;
        }

        .lcd-container { background: #000; padding: 4px; border-radius: 4px; flex: 2; }
        .lcd { background: #9ead94; height: 65px; padding: 8px; text-align: right; border: 2px solid #333; }
        #display { font-size: 32px; font-family: 'Courier New', monospace; font-weight: bold; color: #1a1d18; }
        .indicators { font-size: 10px; color: #1a1d18; height: 10px; font-weight: bold; text-align: left; }
        
        .stack-viewer { 
            background: #222; border: 1px solid #444; border-radius: 4px; 
            padding: 5px; flex: 1; height: 65px; 
            display: flex; flex-direction: column; justify-content: space-between; 
            font-family: 'Courier New', monospace; font-size: 10px; color: #9ead94; 
        }
        .stack-line { display: flex; justify-content: space-between; border-bottom: 1px solid #333; }
        .reg-label { color: #d68a00; font-weight: bold; }

        /* Assinatura */
        .logo { position: absolute; top: 15px; right: 25px; text-align: right; pointer-events: none; }
        .logo h1 { margin: 0; font-size: 18px; font-style: italic; color: #222; }
        .signature { display: block; font-family: 'Brush Script MT', cursive; font-size: 14px; color: #222; }

        /* Teclado Adapt√°vel */
        .keypad { 
            display: grid; 
            grid-template-columns: repeat(10, 1fr); 
            grid-template-rows: repeat(4, 1fr); 
            gap: 25px 8px; /* Mais espa√ßo vertical para os r√≥tulos f/g */
            margin-top: 10px;
            aspect-ratio: 10 / 2.5; /* Mant√©m a propor√ß√£o das teclas */
        }

        .btn-cell { position: relative; width: 100%; height: 40px; }
        .btn { 
            width: 100%; height: 100%; border-radius: 3px; color: #fff; font-size: 12px; font-weight: bold; 
            background: linear-gradient(180deg, #444 0%, #111 100%); border: none; border-bottom: 3px solid #000; cursor: pointer; 
        }
        .btn:active { transform: translateY(2px); border-bottom: 1px solid #000; }
        .btn-f { background: #d68a00 !important; color: #000 !important; }
        .btn-g { background: #0099cc !important; }
        .btn-enter { grid-column: 6; grid-row: 3 / 5; height: 100% !important; background: #555 !important; }
        
        .lbl-f { position: absolute; top: -15px; width: 100%; text-align: center; color: #d68a00; font-size: 8px; font-weight: 900; }
        .lbl-g { position: absolute; top: 42px; width: 100%; text-align: center; color: #0099cc; font-size: 8px; font-weight: 900; }

        /* Bot√£o de Instala√ß√£o Mobile */
        #installBtn { display: none; position: fixed; top: 10px; left: 10px; background: #d68a00; color: #000; border: none; padding: 10px; border-radius: 5px; font-weight: bold; z-index: 1000; }
    </style>
</head>
<body>

<button id="installBtn" onclick="installApp()">üì≤ INSTALAR HP 12c</button>

<div class="hp12c">
    <div class="faceplate">
        <div class="logo">
            <h1>hp 12c</h1>
            <span class="signature">Cl√°udio Santos</span>
        </div>
        
        <div class="display-area">
            <div class="lcd-container">
                <div class="lcd">
                    <div class="indicators"><span id="ind"></span></div>
                    <div id="display">0,00</div>
                </div>
            </div>
            <div class="stack-viewer">
                <div class="stack-line"><span class="reg-label">T:</span><span id="regT">0,00</span></div>
                <div class="stack-line"><span class="reg-label">Z:</span><span id="regZ">0,00</span></div>
                <div class="stack-line"><span class="reg-label">Y:</span><span id="regY">0,00</span></div>
                <div class="stack-line" style="color:#fff"><span class="reg-label">X:</span><span id="regX">0,00</span></div>
            </div>
        </div>

        <div class="keypad">
            <div class="btn-cell"><span class="lbl-f">AMORT</span><button class="btn" onclick="pressTVM('n')">n</button><span class="lbl-g">12x</span></div>
            <div class="btn-cell"><span class="lbl-f">INT</span><button class="btn" onclick="pressTVM('i')">i</button><span class="lbl-g">12√∑</span></div>
            <div class="btn-cell"><span class="lbl-f">NPV</span><button class="btn" onclick="pressTVM('pv')">PV</button><span class="lbl-g">CFo</span></div>
            <div class="btn-cell"><span class="lbl-f">IRR</span><button class="btn" onclick="pressTVM('pmt')">PMT</button><span class="lbl-g">CFj</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressTVM('fv')">FV</button><span class="lbl-g">Nj</span></div>
            <div class="btn-cell"><span class="lbl-f">DATE</span><button class="btn" onclick="pressOp('chs')">CHS</button><span class="lbl-g">BEG</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(7)">7</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(8)">8</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(9)">9</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('/')">√∑</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('yx')">y<sup>x</sup></button><span class="lbl-g">‚àöx</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('1x')">1/x</button><span class="lbl-g">e<sup>x</sup></span></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('%t')">%T</button><span class="lbl-g">LN</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('delta%')">Œî%</button><span class="lbl-g">FRAC</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('%')">%</button><span class="lbl-g">INTg</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('eex')">EEX</button><span class="lbl-g">ODD</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(4)">4</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(5)">5</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(6)">6</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('*')">√ó</button></div>
            <div class="btn-cell"><button class="btn">R/S</button></div>
            <div class="btn-cell"><button class="btn">SST</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('rol')">R‚Üì</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('xy')">x<>y</button></div>
            <div class="btn-cell"><span class="lbl-f">REG</span><button class="btn" onclick="pressOp('clx')">CLX</button><span class="lbl-g">FIN</span></div>
            <button class="btn btn-enter" onclick="pressEnter()">ENTER</button>
            <div class="btn-cell"><button class="btn" onclick="pressNum(1)">1</button><span class="lbl-g">xÃÑ</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(2)">2</button><span class="lbl-g">s</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum(3)">3</button><span class="lbl-g">n!</span></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('-')">-</button></div>
            <div class="btn-cell"><button class="btn" onclick="resetCalc()">ON</button></div>
            <div class="btn-cell"><button class="btn btn-f" onclick="setMode('f')">f</button></div>
            <div class="btn-cell"><button class="btn btn-g" onclick="setMode('g')">g</button></div>
            <div class="btn-cell"><button class="btn" onclick="setMode('sto')">STO</button></div>
            <div class="btn-cell"><button class="btn" onclick="setMode('rcl')">RCL</button></div>
            <div class="btn-cell" style="grid-column: 7;"><button class="btn" onclick="pressNum(0)">0</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressNum('.')">.</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('sigma')">Œ£+</button></div>
            <div class="btn-cell"><button class="btn" onclick="pressOp('+')">+</button><span class="lbl-g">L.R.</span></div>
        </div>
    </div>
</div>

<script>
    let stack = [0,0,0,0], tvm = {n:0,i:0,pv:0,pmt:0,fv:0}, registers = Array(10).fill(0);
    let buffer = "", mode = null, isTyping = false, lastOpWasEnter = false;
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault(); deferredPrompt = e;
        document.getElementById('installBtn').style.display = 'block';
    });

    async function installApp() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') document.getElementById('installBtn').style.display = 'none';
            deferredPrompt = null;
        }
    }

    // REGISTRO SERVICE WORKER (PARA OFFLINE)
    if ('serviceWorker' in navigator) {
        const sw = `const c='hp-v1';self.addEventListener('install',e=>e.waitUntil(caches.open(c).then(a=>a.add(location.href))));self.addEventListener('fetch',e=>e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request))));`;
        const b = new Blob([sw], {type: 'text/javascript'});
        navigator.serviceWorker.register(URL.createObjectURL(b));
    }

    function updateLCD() {
        document.getElementById('display').innerText = isTyping ? buffer.replace('.', ',') : format(stack[0]);
        document.getElementById('regX').innerText = format(stack[0]);
        document.getElementById('regY').innerText = format(stack[1]);
        document.getElementById('regZ').innerText = format(stack[2]);
        document.getElementById('regT').innerText = format(stack[3]);
        document.getElementById('ind').innerText = mode ? mode.toUpperCase() : "";
    }
    function format(v) { return v.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2}); }
    function lift() { stack[3] = stack[2]; stack[2] = stack[1]; stack[1] = stack[0]; }
    function drop() { stack[1] = stack[2]; stack[2] = stack[3]; }
    function pressNum(v) {
        if (mode === 'sto' || mode === 'rcl') { handleMemory(v); return; }
        if (!isTyping) { if (!lastOpWasEnter) lift(); buffer = v === '.' ? "0." : v.toString(); isTyping = true; lastOpWasEnter = false; }
        else { if (v === '.' && buffer.includes('.')) return; buffer += v.toString(); }
        stack[0] = parseFloat(buffer); updateLCD();
    }
    function pressEnter() { if (isTyping) { stack[0] = parseFloat(buffer); isTyping = false; } lift(); buffer = ""; lastOpWasEnter = true; updateLCD(); }
    function pressOp(op) {
        if (isTyping) { stack[0] = parseFloat(buffer); isTyping = false; buffer = ""; }
        let x = stack[0], y = stack[1];
        if (op === '+') { stack[0] = y + x; drop(); }
        else if (op === '-') { stack[0] = y - x; drop(); }
        else if (op === '*') { stack[0] = y * x; drop(); }
        else if (op === '/') { stack[0] = (x !== 0) ? y / x : 0; drop(); }
        else if (op === 'chs') { stack[0] = -x; if(isTyping) buffer = stack[0].toString(); }
        else if (op === 'clx') { if (mode === 'f') { stack.fill(0); } else { stack[0]=0; buffer=""; } }
        else if (op === 'rol') { let t = stack[0]; stack[0]=stack[1]; stack[1]=stack[2]; stack[2]=stack[3]; stack[3]=t; }
        else if (op === 'xy') { stack[0]=y; stack[1]=x; }
        lastOpWasEnter = false; mode = null; updateLCD();
    }
    function pressTVM(k) {
        if (isTyping) { stack[0] = parseFloat(buffer); isTyping = false; buffer = ""; }
        if (stack[0] === 0) {
            const i=tvm.i/100, n=tvm.n, pv=tvm.pv, fv=tvm.fv, pmt=tvm.pmt;
            if (i!==0) {
                let f = Math.pow(1+i, n);
                if (k==='pmt') stack[0]=-(pv*i*f)/(f-1);
                else if (k==='fv') stack[0]=-pv*f-pmt*((f-1)/i);
                else if (k==='pv') stack[0]=(-fv-pmt*((f-1)/i))/f;
            }
        } else { tvm[k] = stack[0]; stack[0] = 0; }
        updateLCD();
    }
    function handleMemory(v) { let i=parseInt(v); if(mode==='sto') registers[i]=stack[0]; else { lift(); stack[0]=registers[i]; } mode=null; updateLCD(); }
    function setMode(m) { mode = mode === m ? null : m; updateLCD(); }
    function resetCalc() { stack.fill(0); tvm={n:0,i:0,pv:0,pmt:0,fv:0}; registers.fill(0); buffer=""; isTyping=false; mode=null; updateLCD(); }
    updateLCD();
</script>
</body>
</html>
